<head>
	<title>yolo</title>
</head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
$(function() {

    var conn;
    var msg = $("#msg");
    var log = $("#log");

    function appendLog(msg) {
        var d = log[0]
        var doScroll = d.scrollTop == d.scrollHeight - d.clientHeight;
        msg.appendTo(log)
        if (doScroll) {
            d.scrollTop = d.scrollHeight - d.clientHeight;
        }
}

     function drawScreen(data) {
        var canvas = document.getElementById('screen');
	var context = canvas.getContext('2d');
	context.clearRect(0, 0, canvas.width, canvas.height);

	for (i = 0; i < data.boxes.length; ++i) {
	  	context.beginPath();
     	 	context.arc(data.boxes[i].X, 600-data.boxes[i].Y, 25, 0, 2 * Math.PI, false);
 		context.fillStyle = "green";
 		context.fill();
      		context.lineWidth = 5;
     		context.strokeStyle = '#003300';
      		context.stroke();	
	}
    }

    if (window["WebSocket"]) {
        conn = new WebSocket("ws://{{$}}/ws");
        conn.onclose = function(evt) {
            appendLog($("<div><b>Connection closed.</b></div>"))
        }
        conn.onmessage = function(evt) {
		console.log(evt.data);
		drawScreen(JSON.parse(evt.data));
        }
    } else {
        appendLog($("<div><b>Your browser does not support WebSockets.</b></div>"))
    }
    });
</script>

<body>

<canvas id="screen" width="600" height="600"></canvas>
<div id="log"></div>
</body>
